<?btl
"addcontent" ?def invert if
	: addcontent 
		@ "content" reverse cell+ 
	;	
then
"webreset" ?def invert if
	: webreset 
		"html" ?var if forget html then
		"head" ?var if forget head then
		"title" ?var if forget title then
		"body" ?var if forget body then
		"form" ?var if forget form then 
		{ tag : "html" , content : [ ] , attrs : { lang : "fr" } , container : "y" } var html 
		{ tag : "head" , content : [ ] , attrs : { } , container : "y" } var head 
		{ tag : "body" , content : [ "Contenu de la page" ] , attrs : { } , container : "y" } var body 
		html head addcontent
		html body addcontent
		{ tag : "title" , content : [ "Ceci est une page test" ] , attrs : { } , container : "y" } var title 
		head title addcontent
		{ tag : "form" , content : [ ] , attrs : { action : "" , method : "post" } , container : "y" } var form
		cls
	;
then
"addattr" ?def invert if
	: addattr ( widgetvarname name value ADDATTR : add an attribut to your widget )
		rot @ "attrs" cell@ cell+
	;
then
"inputwidget" ?def invert if
	: inputwidget
	;
then

webreset
body form addcontent
form "action" "http://localhost/pybee/browser.py?file=myaction&path=default" addattr
html "lang" "en" addattr
"content" { tag : "input" , content : [ ] , attrs : { id : "mydiv" , type : "text" , value : "test" } , container : "n" } form cell+

( id = "mydiv" value = "test" type = "text" inputwidget )

html @ .cr cr

"generate" ?def invert if
	defer generate
	( usage : html @ -- )
	:noname
		dup "tag" cell@ local tag
		dup "content" cell@ local content
		dup "attrs" cell@ local attrs
		"container" cell@ local container
		0 local item
		0 local i
		0 local k
		0 local v
		tag @ "html" = if "<!DOCTYPE html>" .cr then
		"<<!0!>" [ tag @ ] format .

		attrs @ cells 0 > 
		if
			attrs @ keys k !
			attrs @ values v !
			k @ cells i
			do
				" <!0!>='<!1!>'" [ k @ i @ cell@ v @ i @ cell@ ] format .
			loop
		then
		container @ "y" =
		if
			">" .cr
			0 i !
			content @ cells i
			do
				content @ i @ cell@ item !
				item @ ?str
				if
					item @ .cr
				else
					item @ generate
				then
			loop
		else
			"/>" .cr
		then
		container @ "y" =
		if
			"</<!0!>>" [ tag @ ] format .cr
		then
	;
	is generate
then
html @ generate

forget html
forget head
forget title
forget body
forget form
?>