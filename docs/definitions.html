<!DOCTYPE html>
<html>
    <head>
        <title>Définitions</title>
        <link rel="stylesheet" href="main.css">
    </head>
    <body style="font-family:tahoma,arial;">
        <div style="width:400px; float:left;">
            <img src="images/logo.png" width="250"/>
        </div>
        <div style="width:800px; float:left;">
            <h1>XI.3. Structures du langage - Définitions</h1>
        </div>
        <div style="clear:both;"><hr></div>
        <a href="arrays.html">Précédent : XI.2. Structures du langage - Tableaux</a> | <a href="index.html">Index</a> | <a href="conds.html">XI.4. Structures du langage - Conditionnelles</a>

        <h2>a. Généralités</h3>
        <p>
            La création de nouvelles définitions constitue le fond de Beetle. Vous pouvez, par ce moyen, enrichir le vocabulaire de 
            Beetle. Il existe plusieurs façons d'enrichir le vocabulaire :
        </p>
        <ul>
            <li>de manière classique</li>
            <li>les définitions immediates : <b>immediate</b></li>
            <li>les définitions non nommées : <b>:noname</b></li>
            <li>les définitions vides : <b>defer</b></li>
            <li>les variables et constantes : <b>var</b> et <b>const</b></li>
            <li>report d'exécution : <b>postpone</b></li>
        </ul>

        <h2>b. Définitions classiques</h2>
        <p>
            Les définitions classiques vous permettent de définir des mots qui vont enrichir le vocabulaire de Beetle. La syntaxe
            d'une définition classique est la suivante :
        </p>

        <div class="div_code">
            <code>: nom ( commentaire ) instructions ;</code>
        </div>
        <ul>
            <li>Le : indique le début de la définition</li>
            <li>Le ; indique la fin de la définition</li>
            <li>Le commentaire va créer une entrée dans l'aide de Beetle pour cette nouvelle définition</li>
            <li>Après le commentaire et avant le ;, les instructions de la définition sont insérées</li>
        </ul>

        <p>Imaginons que nous ayons besoin d'une définition qui nous donne le carré d'un nombre n, voici comme nous pourrions procéder</p>
        <div class="div_code">
            <code>Beetle> : <b>carre</b> ( obtenir le carre de n ) dup * ;<br>
                <span style="color:green;">ok</span></code>
        </div>
        <p>Dans le vocabulaire, nous allons retrouver notre nouvelle définition.</p>
        <div class="div_code">
            <code>Beetle> words<br>
                -------/core/ (170 words)<br>
                ! % ' ( ) * *! */ + +! +loop , - -> . .2cr .bl .cr .s .scr / 0< 0<= 0= 0> 0>= 1+ 1- 2* 2+ 2- 2.s 2>r 2const 2drop 2dup 2nip 2over 2r> 2rdrop 2rdup 2swap 2var : :noname ; < <= <> = > >= >base >decimal >r ? ?array ?char ?exists ?float ?int ?pack ?str @ @r [ ] again and arcol arget array arrow base base! begin bl bye <b>carre</b> case cell! cell+ cell- cell= cell? cell@ cells cells? char chars cls clt const constants cr create decimal defer do does> drop dump dup else emit endcase endof evaluate execute false forget format help hex if immediate import input invert is kpress leave list load loop max min negate nip octal of or over packages path pick postpone r> r@ rdrop rdump rdup readk recurse repeat reverse roll rot rotonall rover rswap secinput see sp? space swap then true t{ until var variables vp? while words wp? xor { } }t<br>
                <span style="color:green;">ok</span></code>
        </div>
        <p>Et pour utiliser notre nouvelle définition, nous devrons faire comme suit :</p>
        <div class="div_code">
            <code>Beetle> 50 <b>carre</b> .<br>
                2500 <span style="color:green;">ok</span></code>
        </div>
        <p>
            Allons un peu plus loin! Admettons que maintenant, nous avons besoin de la définition <b>cube</b> en utilisant la définition 
            de carre que l'on vient de créer :
        </p>
        <div class="div_code">
            <code>Beetle> : <b>cube</b> ( obtenir le cube de n ) dup carre * ;<br>
                <span style="color:green;">ok</span></code>
        </div>
        <p>Dans le vocabulaire, nous allons retrouver notre nouvelle définition.</p>
        <div class="div_code">
            <code>Beetle> words<br>
                -------/core/ (171 words)<br>
                ! % ' ( ) * *! */ + +! +loop , - -> . .2cr .bl .cr .s .scr / 0< 0<= 0= 0> 0>= 1+ 1- 2* 2+ 2- 2.s 2>r 2const 2drop 2dup 2nip 2over 2r> 2rdrop 2rdup 2swap 2var : :noname ; < <= <> = > >= >base >decimal >r ? ?array ?char ?exists ?float ?int ?pack ?str @ @r [ ] again and arcol arget array arrow base base! begin bl bye <b>carre</b> case cell! cell+ cell- cell= cell? cell@ cells cells? char chars cls clt const constants cr create <b>cube</b> decimal defer do does> drop dump dup else emit endcase endof evaluate execute false forget format help hex if immediate import input invert is kpress leave list load loop max min negate nip octal of or over packages path pick postpone r> r@ rdrop rdump rdup readk recurse repeat reverse roll rot rotonall rover rswap secinput see sp? space swap then true t{ until var variables vp? while words wp? xor { } }t<br>
                <span style="color:green;">ok</span></code>
        </div>
        <p>Et pour utiliser de nouveau le mot <b>cube</b>, nous devrons faire comme suit :</p>
        <div class="div_code">
            <code>Beetle> 50 <b>cube</b> .<br>
                125000 <span style="color:green;">ok</span></code>
        </div>
        <p>Ainsi, vous pouvez imbriquer les appels de définitions indéfiniment comme vous le souhaitez.</p>

        <p>De manière marginale, vous pouvez consulter vos définitions en utilisant le mot <b>see</b></p>
        <div class="div_code">
            <code>Beetle> <b>see</b> carre<br>
                : carre
                        <blockquote>dup *</blockquote>
                ; <span style="color:green;">ok</span><br><br>
                Beetle> <b>see</b> cube<br>
                : cube
                    <blockquote>dup carre *</blockquote>
                ; <span style="color:green;">ok</span></code>
        </div>

        <h2>c. Définitions immediates (immediate)</h2>
        <p>
            Les définitions immediates vous permettent de définir des mots qui vont enrichir le vocabulaire de Beetle de la même façon 
            que pour les définitions classiques. Si cette définition immediate est insérée dans la définition d'un autre mot, elle sera
            interprétée immdiatement. La syntaxe d'une définition immediate est la suivante, il suffit de rajouter le mot
            <b>immediate</b> après le ; :
        </p>

        <div class="div_code">
            <code>: nom ( commentaire ) instructions ; immediate</code>
        </div>
        <p>Voici un exemple d'utilisation du mot <b>immediate</b> qui vous donnera un aperçu de cette fonctionnalité :</p>
        <div class="div_code">
            <code>Beetle> : say-hello "Hello" . ; <b>immediate</b> ( on définit un mot 'say-hello' immediat )<br>
            <span style="color:green;">ok</span> <i>N'affiche rien</i><br><br>
            Beetle> : greet say-hello "I speak Beetle" . ; ( on définit le mot 'greet' qui appelle le mot 'say-hello' immediatement )<br>
            Hello <span style="color:green;">ok</span><br><br>
            Beetle> greet ( on appelle 'greet' seul )<br>
            I speak Beetle <span style="color:green;">ok</span><br><br>
            Beetle> say-hello ( on appelle 'say-hello' seul )<br>
            Hello <span style="color:green;">ok</span></code>
        </div>
        <p>Regardons ce que sont devenues les définitions de 'say-hello' et de 'greet'</p>
        <div class="div_code">
            <code>Beetle> see say-hello<br>
                : say-hello
                        <blockquote>"Hello" .</blockquote>
                ; immediate<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> see greet<br>
                : greet
                        <blockquote>"I speak Beetle" .</blockquote>
                ;<br>
                <span style="color:green;">ok</span></code>
        </div>

        <h2>d. Définitions non nommées (:noname)</h2>
        <p>
            Avec Beetle, vous pouvez créer des mots qui n'ont pas de nom. Pour cela, il vous suffit d'utiliser le mot 
            <b>:noname</b>. Les instructions que vous avez associé à votre définition non nommée vont tout simplement
            se retrouver sur la pile de données. Le mot <b>:noname</b> est associé à une définition nommée en utilisant
            le mot <b>is</b>
        </p>
        <p>Voici un exemple parlant pour vous aider à comprendre le concept :</p>

        <div class="div_code">
            <code>Beetle> defer print ( créons une définition qui n'a pas d'instruction )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> <b>:noname</b> .cr ; ( créons une définition qui n'a pas de nom )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> <b>is</b> print ( ici, on précise que cette définition nom nommée sera associée au mot 'print' )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> 2 print ( nous voulons afficher 2 en utilisant 'print' )<br>
                2<br>
                <span style="color:green;">ok</span>
            </code>
        </div>
        <h2>e. Définitions vides (defer)</h2>
        <p>
            De la même manière que vous pouvez créer des définitions sans nom, vous pouvez créer des définitions sans corps.
            Un exemple vous permettra de comprendre ce que le mot 'defer' fait :
        </p>

        <div class="div_code">
            <code>Beetle> <b>defer</b> .3* ( créons une définition qui n'a pas d'instruction )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> :noname 3 * . ; ( créons une définition qui n'a pas de nom )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> is .3* ( ici, on précise que cette définition nom nommée sera associée au mot '.3*' )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> 2 .3* ( nous voulons afficher 6 en utilisant '.3*' )<br>
                6<br>
                <span style="color:green;">ok</span>
            </code>
        </div>
        <h2>f. Définitions de variables et constantes (var et const)</h2>

        <p>
            Les variables et les constantes sont considérées comme des définitions. Pour les variables :
        </p>

        <div class="div_code">
            <code>Beetle> 30 <b>var</b> temperature ( mémoriser 30 dans la variable temperature : le mot temperature se trouve immédiatement sur la pile de travail )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> 30 <b>var</b> temperature @ .( vous pouvez écrire ceci du coup pour afficher diretement le contenu de votre variable température )<br>
                30 <span style="color:green;">ok</span><br><br>
                Beetle> 3.5 <b>var</b> secondes ( mémoriser 3.5 dans la variable secondes )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> "Une chaine de caractères" <b>var</b> chaine ( mémoriser "Une chaine de caractères" dans la variable chaine )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> [ 1 2 ] <b>var</b> tableau ( mémoriser un tableau indéxé dans la variable tableau )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> { n1 : 1 , n2 : 2 } <b>var</b> hashtable ( mémoriser une table de hachage dans la variable hashtable )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> hashtable @ . ( pour afficher le contenu de hashable )<br>
                {'n1':1, 'n2':2} <span style="color:green;">ok</span><br><br>
                Beetle> { n3 : 3 , n4 : 4 } hashtable ! ( pour modifier le contenu de hashtable )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> forget hashtable ( pour supprimer hashtable de votre vocabulaire )<br>
                <span style="color:green;">ok</span>
            </code>
        </div>

        <p>Pour les constantes que vous pouvez définir mais que vous ne pourrez pas modifier :</p>

        <div class="div_code">
            <code>Beetle> 30 <b>const</b> temperature ( mémoriser 30 dans la constante temperature )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> 3.5 <b>const</b> secondes ( mémoriser 3.5 dans la constante secondes )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> "Une chaine de caractères" <b>const</b> chaine ( mémoriser "Une chaine de caractères" dans la constante chaine )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> [ 1 2 ] <b>const</b> tableau ( mémoriser un tableau indéxé dans la constante tableau )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> { n1 : 1 , n2 : 2 } <b>const</b> hashtable ( mémoriser une table de hachage dans la constante hashtable )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> hashtable . ( pour afficher le contenu de hashable : contrairement à une variable, vous ne pouvez pas modifier une constante. Vous ne pouvez pas utiliser ! )<br>
                {'n1':1, 'n2':2} <span style="color:green;">ok</span><br><br>
                Beetle> forget hashtable ( pour supprimer hashtable de votre vocabulaire )<br>
                <span style="color:green;">ok</span>
            </code>
        </div>

        <h2>g. Report d'exécution (postpone)</h2>
        <p>
            l'instruction <b>postpone</b> vous permet de reporter l'exécution d'un mot. Voici un exemple qui va vous donner une idée de
            ce que fait <b>postpone</b> :
        </p>

        <div class="div_code">
            <code>Beetle> : someword "Hello" . ; ( on définit le mot simple 'someword' )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> see someword ( voir la définition de someword )<br>
                : sw
                    <blockquote>"Hello" .</blockquote>
                ;<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> : imm postpone someword "I'm Beetle" . ; immediate ( créer une définition imediate contenant un postpone )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> see imm ( voir la définition de 'imm' )<br>
                : imm<br>
                    <blockquote>someword "I'm Beetle" .</blockquote> 
                ; immediate<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> : exemple imm ; ( créer une nouvelle définition 'exemple' )<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> see exemple ( voir la définition de 'exemple' )<br>
                : exemple<br>
                    <blockquote>someword</blockquote> 
                ;<br>
                <span style="color:green;">ok</span><br><br>
                Beetle> someword ( exécution de 'someword' )<br>
                Hello <span style="color:green;">ok</span><br><br>
                Beetle> imm ( exécution de 'imm' )<br>
                I'm Beetle <span style="color:green;">ok</span><br><br>
                Beetle> exemple ( exécution de 'exemple' )<br>
                Hello <span style="color:green;">ok</span><br><br>
                Beetle> postpone ( doit entrainer une erreur )<br>
                <span style="color:magenta;">postpone error : variable or definition name is missing</span><br>
                <span style="color:green;">ok</span><br><br>
                Beetle> postpone dup ( ne fait rien : du point de vue de la sémantique, c'est correct mais ça ne veut rien dire )<br>
                <span style="color:green;">ok</span><br><br>
            </code>
        </div>

        <a href="arrays.html">Précédent : XI.2. Structures du langage - Tableaux</a> | <a href="index.html">Index</a> | <a href="conds.html">XI.4. Structures du langage - Conditionnelles</a>

    </body>
</html>